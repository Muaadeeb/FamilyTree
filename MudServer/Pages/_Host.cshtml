@page "/"
@namespace MudServer.Pages
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@{
    Layout = "_Layout";
}

@*<script src="https://www.gstatic.com/charts/loader.js"></script>*@

@*<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script>
    google.charts.load('current', { packages: ["orgchart"] });

    function drawChart(elementId, data) {
        console.log(data);
        console.log(google.visualization);
        console.log(elementId);
        var chart = new google.visualization.OrgChart(document.getElementById(elementId));
        var dataTable = new google.visualization.DataTable();
        dataTable.addColumn('string', 'Id');
        dataTable.addColumn('string', 'ParentId');
        dataTable.addColumn('string', 'Name');

        function addNode(node) {
            console.log('0 -' + [node]);
            console.log('1 -' + [node.Id, node.ParentId || '', node.Name]);
            dataTable.addRow([node.Id, node.ParentId || '', node.Name]);
            if (node.Children) {
                console.log('addNode called for node ' + node.Id);
                node.Children.forEach(addNode);
            }
        }
        console.log('addNode: ' + [data]);
        addNode(data);
        console.log(dataTable.toJSON());
        console.log('drawChart called');
        chart.draw(dataTable);
        console.log('chart.draw called');
    }
</script>
*@
<component type="typeof(App)" render-mode="ServerPrerendered" />